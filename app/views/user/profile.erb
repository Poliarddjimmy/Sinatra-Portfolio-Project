<% @title = @user.pseudo %>
<link rel="stylesheet" href="/stylesheets/bootstrap.min.css" />

<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>

<style media="screen">
/* USER PROFILE PAGE */
.card {
  margin-top: 20px;
  padding: 30px;
  background-color: rgba(214, 224, 226, 0.2);
  -webkit-border-top-left-radius:5px;
  -moz-border-top-left-radius:5px;
  border-top-left-radius:5px;
  -webkit-border-top-right-radius:5px;
  -moz-border-top-right-radius:5px;
  border-top-right-radius:5px;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.card.hovercard {
  position: relative;
  padding-top: 0;
  overflow: hidden;
  text-align: center;
  background-color: #00CED1;
  width: 100%;

}
.card.hovercard .card-background {
  height: 130px;
}
.card-background img {

  margin-left: -100px;
  margin-top: -200px;
  min-width: 130%;
}
.card.hovercard .useravatar {
  position: absolute;
  top: 15px;
  left: 0;
  right: 0;
}
.card.hovercard .useravatar img {
  width: 120px;
  height: 120px;
  max-width: 120px;
  max-height: 120px;
  -webkit-border-radius: 50%;
  -moz-border-radius: 50%;
  border-radius: 50%;
  border: 5px solid rgba(255, 255, 255, 0.5);
}
.card.hovercard .card-info {
  position: absolute;
  bottom: 14px;
  left: 0;
  right: 0;
}
.card-title {
  padding:0 5px;
  font-size: 40px;
  font-family: cursive;
  line-height: 1;
  color: #00CED1;
  background-color: rgba(255, 255, 255, 0.1);
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
}
.card.hovercard .card-info {
  padding:0 5px;
  font-size: 20px;
  line-height: 1;
  color: #262626;
  background-color: rgba(255, 255, 255, 0.1);
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
}
.card.hovercard .card-info {
  overflow: hidden;
  font-size: 12px;
  line-height: 20px;
  color: #737373;
  text-overflow: ellipsis;
}
.card.hovercard .bottom {
  padding: 0 20px;
  margin-bottom: 17px;
}
.btn-pref .btn {
  -webkit-border-radius:0 !important;
}
.btn.btn-primary {
  font-family:cursive;
  font-size:20;
  color:#00CED1;
}
p {
  font-family: serif;
  font-size:18px;
  color:#00CED1;
}
h3 {
  font-family: serif;
  font-size:25px;
  color:#00CED1;
}
#AboutPiece, #AboutMe, #Portfolio, #ContactMe{
   background-color: #FFEBCD;
}
.well {
  background-color: #FFFAF0;
}
</style>

<script type="text/javascript">
$(document).ready(function() {
$(".btn-pref .btn").click(function () {
  $(".btn-pref .btn").removeClass("btn-primary").addClass("btn-default");
  // $(".tab").addClass("active"); // instead of this do the below
  $(this).removeClass("btn-default").addClass("btn-primary");
});
});
</script>

<div class="container">
  <div class="row">
    <div class="col-lg-12 col-sm-12">
    <div class="card hovercard">
      <div class="card-background">
        <img class="card-bkimg" alt="" src="https://scontent-yyz1-1.xx.fbcdn.net/v/t1.0-9/5792_167366633419376_1680462766_n.jpg?oh=1fa3d2de8138d129be0b9026307f6431&oe=59019AA8">
      </div>
      <div class="useravatar">
          <img alt="" src="images/user.png">
      </div>
      <!--<div class="card-info"> <span class="card-title"><%= @user.last_name %> <%= @user.first_name %></span>
      </div>-->
    </div>


    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link active" data-toggle="tab" href="#about">
          About
          <% if @user.id == @user1.id %>
            me
            <% else %>
              <%= @user.pseudo %>
          <% end %>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#portfolio">Portfolio</a>
      </li>
      <li class="nav-item">
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Option</a>
        <div class="dropdown-menu">
          <% if @user.id == @user1.id %>
          <a class="dropdown-item" data-toggle="tab" href="#password">Chage password</a>
          <% end %>
          <div class="dropdown-divider"></div>
          <% if @user.id == @user1.id ||  @user1.is_admin == 1 %>
          <a class="dropdown-item" data-toggle="tab" href="#delete">Delete account</a>
          <% end %>
        </div>

      </li>

    </ul>
    <div id="myTabContent" class="tab-content">
      <style media="screen">
        .tab-pane .fa{color:rgba(255,255,255,1);}
      </style>
      <div class="tab-pane fade show" id="password">
        <br>
        <form id="" action="/edit/password/<%= @user.id %>" method="post" >
           <input id="hidden" type="hidden" name="_method" value="PATCH">
           <div class="form-group">
             <label for="exampleInputEmail1">Old password</label>
             <input type="password" name="password" class="form-control"  aria-describedby="emailHelp" placeholder="Old password here" style="">
             <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
           </div>

           <div class="form-group">
             <label for="exampleInputEmail1">New password</label>
             <input type="password" name="pwd" class="form-control" aria-describedby="emailHelp" placeholder="New password here" style="">
             <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
           </div>

           <button type="submit"  class="btn btn-sm btn-info" style="margin-right:10px;margin-top:;">
             Change
           </button>
           <br>
         </form>
      </div>

      <div class="tab-pane fade show" id="delete">
        <br>
        <a href="/delete/user/<%= @user.id %>" class="btn btn-warning"> Click here if you realy want to delete your account</a>
      </div>
      <div class="tab-pane fade show active" id="about">
        <br>
        <% if flash[:success] %>
          <div id="success" style="color:rgba(255,255,255,1);">
          <%= flash[:success] %>
          </div>
          <br>
        <% end %>


        <div class="col-sm-3 col-xs-12" style="float:left; border-right:rgba(255,255,255,0.3) 1px solid;">
          <img src="/images/user.png" alt="<%= @user.pseudo %>" class="thumbnail" style="width:100%;">
        </div>
        <div class="col-sm-9 col-xs-12" style="float:left;">
        <h1 style="color:#00CED1;">
          <div style="text-align:center;">
            <div id="firstname">
              <%= @user.last_name %>
              <span style="color:rgba(255,255,255,1); "><%= @user.first_name %></span>

              <% if @user.id == @user1.id %>
              <button id="edit" onclick="document.getElementById('edit').style.display='none';document.getElementById('efirstname').style.display='block';document.getElementById('firstname').style.display='none';" class=""style="float:rights; font-size:0.5em; background-color:rgba(255,255,255,0.000000001); border:red 0px solid;">
                <i class="fa fa-edit"></i>
              </button>
              <% end %>
            </div>
          </div>
        </h1>


          <form id="efirstname" style="display:none;" class="" action="/edit/user/<%= @user.pseudo %>" method="post">
            <input id="hidden" type="hidden" name="_method" value="PATCH">
            <div>
              <div class="form-group" style="">

                <div class="form-group">
                  <label for="exampleInputEmail1">Last Name</label>
                  <input type="text" name="last_name" value="<%= @user.last_name %>" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="The course's name">
                  <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                </div>

                <div class="form-group">
                  <label for="exampleInputEmail1">First Name</label>
                  <input type="text" name="first_name" value="<%= @user.first_name %>" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="The course's name">
                  <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                </div>

                <b onclick="document.getElementById('next').style.display='none';document.getElementById('last').style.display='block';" style="display:inline-block;" id="next" class="btn btn-info btn-sm" name="button">Next</b>
                <div class="" id="last" style="display:none;">
                  <div class="form-group">
                    <label for="exampleInputEmail1">Enter your password to continue</label>
                    <input type="password" name="password" value="" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="your password here">
                    <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                  </div>

                  <input type="submit" class="btn btn-sm btn-success" value="Submit change">
                  <span onclick="document.getElementById('edit').style.display='inline-block';document.getElementById('efirstname').style.display='none';document.getElementById('firstname').style.display='inline-block'; document.getElementById('next').style.display='inline-block'; document.getElementById('last').style.display='none';" class="btn btn-sm btn-warning">Cancel</span>
                </div>
              </div>
            </div>

          </form>

          <br><br>

      </div>



      </div>


      <div class="tab-pane fade show" id="portfolio">
        <br>
        <h3>Modul complete</h3>
        <p style="color:rgba(255,255,255,1);">
          <%
            @mo = @user.modul_users.all

            if @mo
              @mo.each do |modu|
                @m = Modul.find_by_id(modu.modul_id)
          %>
            <%= @m.modul_title %>
          <% end end %>
        </p>
      </div>

    </div>

  </div>
</div>
